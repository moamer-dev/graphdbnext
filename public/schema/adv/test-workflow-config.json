{
  "version": 1,
  "type": "workflow-config",
  "createdAt": "2025-12-19T00:00:00.000Z",
  "_note": "IMPORTANT: Before importing this config, you must first import test-workflow.xml and map all XML elements to node labels. Map: edxml→Edxml, header→Header, text→Text, surface→Surface, column→Column, line→Line, seg→Seg, w→W, structure→Structure, stanza→Stanza, verse→Verse, note→Note, title→Title, author→Author, p→P, translation→Translation, pc→Pc, textClass→Textclass, classCode→Classcode, damage→Damage, unclear→Unclear, choice→Choice, corr→Corr, sic→Sic, term→Term",
  "relationships": [
    {
      "fromNodeLabel": "Edxml",
      "toNodeLabel": "Header",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Edxml",
      "toNodeLabel": "Text",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Header",
      "toNodeLabel": "Title",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Header",
      "toNodeLabel": "Textclass",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Textclass",
      "toNodeLabel": "Classcode",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Header",
      "toNodeLabel": "Author",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Text",
      "toNodeLabel": "Surface",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Surface",
      "toNodeLabel": "Column",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Column",
      "toNodeLabel": "Line",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Line",
      "toNodeLabel": "Seg",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Seg",
      "toNodeLabel": "W",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Seg",
      "toNodeLabel": "Pc",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "W",
      "toNodeLabel": "Damage",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Damage",
      "toNodeLabel": "Unclear",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Text",
      "toNodeLabel": "Structure",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Structure",
      "toNodeLabel": "Stanza",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Stanza",
      "toNodeLabel": "Verse",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Verse",
      "toNodeLabel": "W",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Text",
      "toNodeLabel": "Note",
      "type": "annotates",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Text",
      "toNodeLabel": "Translation",
      "type": "translates",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Text",
      "toNodeLabel": "Choice",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Choice",
      "toNodeLabel": "Corr",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Choice",
      "toNodeLabel": "Sic",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Corr",
      "toNodeLabel": "W",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Sic",
      "toNodeLabel": "W",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Note",
      "toNodeLabel": "P",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Note",
      "toNodeLabel": "Term",
      "type": "contains",
      "cardinality": "one-to-many"
    },
    {
      "fromNodeLabel": "Note",
      "toNodeLabel": "W",
      "type": "references",
      "cardinality": "many-to-many"
    },
    {
      "fromNodeLabel": "Translation",
      "toNodeLabel": "Seg",
      "type": "contains",
      "cardinality": "one-to-many"
    }
  ],
  "tools": [
    {
      "type": "tool:if",
      "label": "Check W Has Text Attribute",
      "targetNodeLabel": "W",
      "config": {
        "conditionGroups": [
          {
            "id": "has_text_attr",
            "conditions": [
              {
                "type": "HasAttribute",
                "attributeName": "text",
                "internalOperator": "OR"
              }
            ],
            "internalOperator": "AND"
          }
        ]
      },
      "position": { "x": 800, "y": 200 },
      "inputs": 1,
      "outputs": [
        { "id": "true", "label": "True" },
        { "id": "false", "label": "False" }
      ]
    },
    {
      "type": "tool:switch",
      "label": "Switch by Lemma",
      "targetNodeLabel": "W",
      "config": {
        "switchSource": "attribute",
        "switchAttributeName": "lemma",
        "switchCases": [
          { "id": "case1", "value": "test", "label": "test-word" },
          { "id": "case2", "value": "workflow", "label": "workflow-word" },
          { "id": "case3", "value": "default", "label": "default" }
        ]
      },
      "position": { "x": 800, "y": 350 },
      "inputs": 1,
      "outputs": [
        { "id": "test-word", "label": "test-word" },
        { "id": "workflow-word", "label": "workflow-word" },
        { "id": "default", "label": "default" }
      ]
    },
    {
      "type": "tool:filter",
      "label": "Filter Damage Elements",
      "targetNodeLabel": "W",
      "config": {
        "filterMode": "ignoreSubtree",
        "elementNames": ["damage", "unclear"]
      },
      "position": { "x": 800, "y": 500 },
      "inputs": 1,
      "outputs": [
        { "id": "output", "label": "Output" }
      ]
    },
    {
      "type": "tool:transform",
      "label": "Transform Attributes",
      "targetNodeLabel": "W",
      "config": {
        "mappings": [
          {
            "id": "mapping1",
            "source": "lemma",
            "target": "lemmaProperty",
            "defaultValue": "unknown"
          },
          {
            "id": "mapping2",
            "source": "ana",
            "target": "posTag",
            "defaultValue": ""
          },
          {
            "id": "mapping3",
            "source": "cert",
            "target": "certainty",
            "defaultValue": "low"
          }
        ]
      },
      "position": { "x": 800, "y": 650 },
      "inputs": 1,
      "outputs": [
        { "id": "output", "label": "Output" }
      ]
    },
    {
      "type": "tool:loop",
      "label": "Loop Through Seg Children",
      "targetNodeLabel": "Seg",
      "config": {
        "filterChildren": ["w", "pc"],
        "maxDepth": 2,
        "skipIgnored": true
      },
      "position": { "x": 800, "y": 100 },
      "inputs": 1,
      "outputs": [
        { "id": "output", "label": "Output" }
      ]
    }
  ],
  "toolEdges": [
    {
      "sourceToolLabel": "",
      "targetToolLabel": "W::tool:if",
      "sourceHandle": "tools",
      "targetHandle": "input-0"
    },
    {
      "sourceToolLabel": "",
      "targetToolLabel": "W::tool:switch",
      "sourceHandle": "tools",
      "targetHandle": "input-0"
    },
    {
      "sourceToolLabel": "",
      "targetToolLabel": "W::tool:filter",
      "sourceHandle": "tools",
      "targetHandle": "input-0"
    },
    {
      "sourceToolLabel": "",
      "targetToolLabel": "W::tool:transform",
      "sourceHandle": "tools",
      "targetHandle": "input-0"
    },
    {
      "sourceToolLabel": "",
      "targetToolLabel": "Seg::tool:loop",
      "sourceHandle": "tools",
      "targetHandle": "input-0"
    }
  ],
  "actions": [
    {
      "type": "action:create-node",
      "label": "Create W Node",
      "config": {
        "labels": ["W"],
        "parentRelationship": "contains",
        "properties": [
          {
            "key": "xmlId",
            "value": "xml:id",
            "source": "attribute"
          },
          {
            "key": "lemma",
            "value": "lemma",
            "source": "attribute"
          }
        ]
      },
      "position": { "x": 1200, "y": 200 }
    },
    {
      "type": "action:create-node-tokens",
      "label": "Create Character Nodes",
      "config": {
        "targetLabel": "Character",
        "relationshipType": "contains",
        "splitBy": "",
        "filterPattern": "[a-zA-Z0-9]",
        "properties": [
          {
            "key": "id",
            "source": "attribute",
            "attributeName": "id"
          },
          {
            "key": "text",
            "source": "token"
          }
        ]
      },
      "position": { "x": 1200, "y": 350 }
    },
    {
      "type": "action:extract-property",
      "label": "Extract Lemma Property",
      "config": {
        "sourceAttribute": "lemma",
        "targetPropertyKey": "extractedLemma",
        "defaultValue": "unknown"
      },
      "position": { "x": 1200, "y": 500 }
    },
    {
      "type": "action:set-property",
      "label": "Set Processed Property",
      "config": {
        "propertyKey": "processed",
        "propertyValue": "true"
      },
      "position": { "x": 1200, "y": 650 }
    },
    {
      "type": "action:extract-text",
      "label": "Extract Text Content",
      "config": {
        "extractionMode": "text"
      },
      "position": { "x": 1200, "y": 800 }
    },
    {
      "type": "action:transform-text",
      "label": "Transform to Lowercase",
      "config": {
        "transformType": "lowercase"
      },
      "position": { "x": 1200, "y": 950 }
    },
    {
      "type": "action:create-reference",
      "label": "Create Reference",
      "config": {
        "referenceAttribute": "corresp",
        "relationshipType": "references"
      },
      "position": { "x": 1200, "y": 1100 }
    },
    {
      "type": "action:create-annotation",
      "label": "Create Annotation",
      "config": {
        "annotationTypes": ["lemma", "pos"]
      },
      "position": { "x": 1200, "y": 1250 }
    },
    {
      "type": "action:process-children",
      "label": "Process Children",
      "config": {
        "filterByTag": ["w", "g"],
        "excludeTags": ["damage"],
        "recursive": true
      },
      "position": { "x": 1200, "y": 1400 }
    }
  ],
  "actionEdges": [
    {
      "sourceToolLabel": "W::tool:if",
      "targetActionLabel": "Create W Node",
      "sourceHandle": "true",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:if",
      "targetActionLabel": "Create Character Nodes",
      "sourceHandle": "true",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:switch",
      "targetActionLabel": "Extract Lemma Property",
      "sourceHandle": "test-word",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:filter",
      "targetActionLabel": "Set Processed Property",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:transform",
      "targetActionLabel": "Extract Text Content",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:transform",
      "targetActionLabel": "Transform to Lowercase",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "W::tool:transform",
      "targetActionLabel": "Create Reference",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "Seg::tool:loop",
      "targetActionLabel": "Create Annotation",
      "sourceHandle": "output",
      "targetHandle": "input"
    },
    {
      "sourceToolLabel": "Seg::tool:loop",
      "targetActionLabel": "Process Children",
      "sourceHandle": "output",
      "targetHandle": "input"
    }
  ]
}

